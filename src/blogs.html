<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SN - Blogs</title>
    <link rel="icon" type="image/x-icon" href="resources/icons/favicon.ico">
    <script>
        // Set theme immediately to prevent FOUC (Flash of Unstyled Content)
        (function() {
            const savedTheme = localStorage.getItem("theme") || "light";
            document.documentElement.setAttribute("data-theme", savedTheme);
        })();
    </script>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        const renderer = new marked.Renderer();
        renderer.link = function (href, title, text) {
            let linkHref = href;
            let linkText = text;
            let linkTitle = title;
            if (typeof href === "object" && href !== null) {
                linkHref = href.href || "";
                linkText = href.text || text || "";
                linkTitle = href.title || title || "";
            }
            linkHref = linkHref.replace(/"/g, "&quot;");
            linkText = linkText || "Link";
            return `<a href="${linkHref}" target="_blank" rel="noopener noreferrer" ${linkTitle ? `title="${linkTitle}"` : ""
                }>${linkText}</a>`;
        };
        marked.setOptions({
            renderer: renderer,
            highlight: function (code, lang) {
                const hljs = window.hljs;
                return hljs.highlight(code, { language: lang }).value;
            },
            langPrefix: "hljs language-",
        });
        document.addEventListener("DOMContentLoaded", () => {
            hljs.highlightAll();
        });
    </script>
</head>

<body>
    <button id="backToTop" title="Go to top">⬆</button>

    <div id="banner-placeholder"></div>

    <!-- Mobile toggle (always present in DOM, shown via CSS on small screens) -->
    <button id="sidebarFloatingToggle" class="mobile-sidebar-toggle" aria-label="Open menu">☰</button>

    <section class="content-scale-wrapper">
        <div class="blog-list" id="blogList">
            <div class="blog-list-header">
                <button id="toggleBlogList" class="toggle-btn">☰</button>
                <input type="text" id="blogSearch" class="blog-search" placeholder="Search blogs..." />
            </div>
            <div class="sidebar-inner">
                <ul id="blogListItems">
                    <!-- dynamically filled -->
                </ul>
            </div>
        </div>

        <div class="blog-container">
            <div class="blog-content" id="blogContent">
                <div class="blog-text" id="blogText">Loading blog post...</div>
            </div>
        </div>
    </section>

    <script src="script.js"></script>
    <script>
        // Load banner
        fetch("banner.html")
            .then(response => response.text())
            .then(html => {
                document.getElementById("banner-placeholder").innerHTML = html;
                if (typeof initDropdownToggle === "function") {
                    initDropdownToggle();
                }
            })
            .catch(error => console.error("Failed to load banner:", error));

        // Initialize blog page
        document.addEventListener("DOMContentLoaded", () => {
            if (typeof initBlogPage === "function") {
                initBlogPage();
            }
        });
    </script>

</body>

</html>