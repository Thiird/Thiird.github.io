<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SN - Career</title>
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
    <script>
        (function() {
            try {
                const savedTheme = localStorage.getItem("theme") || "light";
                document.documentElement.setAttribute("data-theme", savedTheme);
            } catch(e) {
                document.documentElement.setAttribute("data-theme", "light");
            }
        })();
    </script>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        const renderer = new marked.Renderer();
        renderer.link = function (href, title, text) {
            let linkHref = href;
            let linkText = text;
            let linkTitle = title;
            if (typeof href === "object" && href !== null) {
                linkHref = href.href || "";
                linkText = href.text || text || "";
                linkTitle = href.title || title || "";
            }
            linkHref = linkHref.replace(/"/g, "&quot;");
            linkText = linkText || "Link";
            return `<a href="${linkHref}" target="_blank" rel="noopener noreferrer" ${linkTitle ? `title="${linkTitle}"` : ""}>${linkText}</a>`;
        };
        marked.setOptions({
            renderer: renderer
        });
    </script>
  </head>
  <body>
    <button id="backToTop" title="Go to top">â¬†</button>
    <div id="banner-placeholder"></div>

    <section class="content-container">
      <div class="content-text" id="contentText">Loading career info...</div>
    </section>

    <script src="script.js"></script>
    <script>
      function adjustThemeTogglePosition() {
        requestAnimationFrame(() => {
          const banner = document.getElementById("banner-placeholder");
          const themeToggle = document.getElementById("themeToggle");
          if (banner && themeToggle) {
            const bannerRect = banner.getBoundingClientRect();
            const bannerBottom = Math.max(0, bannerRect.bottom);
            themeToggle.style.top = `${bannerBottom + 10}px`;
            themeToggle.classList.add("positioned");
          }
        });
      }

      fetch("banner.html")
        .then(response => response.text())
        .then(html => {
          document.getElementById("banner-placeholder").innerHTML = html;
          if (typeof initDropdownToggle === "function") {
            initDropdownToggle();
          }
          adjustThemeTogglePosition();
        })
        .catch(err => console.error("Failed to load banner:", err));

      // Update position on scroll
      window.addEventListener("scroll", adjustThemeTogglePosition);
      window.addEventListener("touchmove", adjustThemeTogglePosition, { passive: true });
      window.addEventListener("load", adjustThemeTogglePosition);

      fetch("career/career.md")
        .then(response => response.text())
        .then(markdown => {
          // Process relative links to point to career folder (similar to blog processing)
          let md = markdown.replace(
            /\[([^\]]+)\]\(([^)]+)\)/g,
            (match, text, href) => {
              // If it's a relative path (not http and no slashes), prepend career/
              if (!href.startsWith('http') && !href.includes('/')) {
                return `[${text}](career/${href})`;
              }
              return match;
            }
          );
          
          const html = marked.parse(md);
          document.getElementById("contentText").innerHTML = html;
        })
        .catch(err => {
          document.getElementById("contentText").innerHTML = '<p>Failed to load career information.</p>';
          console.error("Failed to load career markdown:", err);
        });
    </script>
  </body>
</html>
